{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport class PixabayApi {\n  #BASE_URL = 'https://pixabay.com/api/';\n  #API_KEY = '50190409-57f653f3b13017a76580224dc';\n  #query = '';\n  #page = 1;\n  #per_page = 15;\n  #total_pages = 1;\n\n  async getImagesByQuery() {\n    try {\n      const res = await axios.get(this.#BASE_URL, {\n        params: {\n          q: this.#query,\n          key: this.#API_KEY,\n          image_type: 'photo',\n          orientation: 'horizontal',\n          safesearch: true,\n          per_page: this.#per_page,\n          page: this.#page,\n        },\n      });\n      this.calculateTotalPages(res.data.totalHits);\n\n      return res.data;\n    } catch (error) {\n      return error;\n    }\n  }\n\n  calculateTotalPages(totalHits) {\n    this.totalPages = Math.max(1, Math.ceil(totalHits / this.#per_page));\n  }\n\n  set query(newQuery) {\n    this.#query = newQuery;\n  }\n\n  set page(newPage) {\n    this.#page = newPage;\n  }\n\n  set totalPages(newTotalPages) {\n    this.#total_pages = newTotalPages;\n  }\n\n  get query() {\n    return this.#query;\n  }\n\n  get page() {\n    return this.#page;\n  }\n\n  get per_page() {\n    return this.#per_page;\n  }\n  get totalPages() {\n    return this.#total_pages;\n  }\n\n  nextPage() {\n    return (this.#page += 1);\n  }\n\n  resetPage() {\n    this.#page = 1;\n  }\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst simpleLightbox = new SimpleLightbox('.js-gallery .image-link', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\nconst galleryEl = document.querySelector('.js-gallery');\n\nfunction createGallery(images) {\n  const markup = images\n    .map(\n      ({\n        tags,\n        largeImageURL,\n        webformatURL,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) =>\n        `<li class=\"gallery-item js-gallery-item\">\n                <div>\n                  <a href=\"${largeImageURL}\" class=\"image-link\">\n                    <img\n                      src=\"${webformatURL}\"\n                      alt=\"${tags}\"\n                      class=\"gallery-image\"\n                    />\n                  </a>\n                </div>\n                <div>\n                  <ul class=\"image-info\">\n                    <li class=\"info-item\">\n                      <p class=\"info-value-tittle\">Likes</p>\n                      <p class=\"info-value\" data-likes>${likes}</p>\n                    </li>\n                    <li class=\"info-item\">\n                      <p class=\"info-value-tittle\">Views</p>\n                      <p class=\"info-value\" data-views>${views}</p>\n                    </li>\n                    <li class=\"info-item\">\n                      <p class=\"info-value-tittle\">Comments</p>\n                      <p class=\"info-value\" data-comments>${comments}</p>\n                    </li>\n                    <li class=\"info-item\">\n                      <p class=\"info-value-tittle\">Downloads</p>\n                      <p class=\"info-value\" data-downloads>${downloads}</p>\n                    </li>\n                  </ul>\n                </div>\n              </li>`\n    )\n    .join('');\n\n  galleryEl.insertAdjacentHTML('beforeend', markup);\n}\n\nfunction clearGallery() {\n  galleryEl.innerHTML = '';\n}\n\nfunction showElement(element) {\n  element.classList.remove('hidden');\n}\n\nfunction hideElement(element) {\n  element.classList.add('hidden');\n}\n\nexport {\n  createGallery,\n  clearGallery,\n  showElement,\n  hideElement,\n  simpleLightbox,\n};\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport { PixabayApi } from './js/pixabay-api';\nimport {\n  createGallery,\n  clearGallery,\n  showElement,\n  hideElement,\n  simpleLightbox,\n} from './js/render-functions';\n\nconst api = new PixabayApi();\n\nconst formEl = document.querySelector('.js-form');\nconst loader = document.querySelector('.js-loader');\nconst loadMoreBtn = document.querySelector('#load-more-button');\n\nformEl.addEventListener('submit', handleFormSubmit);\nloadMoreBtn.addEventListener('click', handleLoadMoreBtnClick);\n\nasync function handleFormSubmit(event) {\n  event.preventDefault();\n\n  api.resetPage();\n\n  api.query = event.target.elements['search-text'].value.trim();\n\n  if (!api.query) {\n    iziToast.warning({\n      position: 'topRight',\n      message: 'Please enter the correct query!',\n    });\n    return;\n  }\n\n  clearGallery();\n  showElement(loader);\n\n  try {\n    const data = await api.getImagesByQuery();\n    //? const data = await getImagesByQuery(query, page);\n\n    if (data.hits.length === 0) {\n      iziToast.warning({\n        position: 'topRight',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n      });\n      clearGallery();\n      return;\n    }\n\n    createGallery(data.hits);\n    const newCards = document.querySelectorAll('.gallery-item:not(.show)');\n    addAnimationToCards(newCards);\n\n    checkBtnStatus();\n    simpleLightbox.refresh();\n  } catch (error) {\n    iziToast.error({\n      position: 'topRight',\n      message: `ERROR: ${error}`,\n    });\n  } finally {\n    hideElement(loader);\n    formEl.reset();\n  }\n}\n\n// ======================\n\nasync function handleLoadMoreBtnClick() {\n  showElement(loader);\n\n  try {\n    api.nextPage();\n\n    const data = await api.getImagesByQuery();\n    if (api.page >= api.totalPages) {\n      checkBtnStatus();\n      iziToast.info({\n        position: 'topRight',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    }\n\n    createGallery(data.hits);\n    const newCards = document.querySelectorAll('.gallery-item:not(.show)');\n    addAnimationToCards(newCards);\n\n    scrollToNewItems();\n    checkBtnStatus();\n    simpleLightbox.refresh();\n  } catch (error) {\n    iziToast.error({\n      position: 'topRight',\n      message: `ERROR: ${error}`,\n    });\n  } finally {\n    hideElement(loader);\n  }\n}\n\nfunction checkBtnStatus() {\n  if (api.page < api.totalPages) {\n    showElement(loadMoreBtn);\n  } else {\n    hideElement(loadMoreBtn);\n  }\n}\n\nfunction scrollToNewItems() {\n  const galleryItem = document.querySelector('.js-gallery-item');\n  if (galleryItem) {\n    const elementHeight = galleryItem.getBoundingClientRect().height;\n    window.scrollBy({\n      top: elementHeight * 3 + 22,\n      behavior: 'smooth',\n    });\n  }\n}\n\n// ======================\n\nfunction addAnimationToCards(newCards) {\n  newCards.forEach((card, index) => {\n    setTimeout(() => {\n      card.classList.add('show');\n    }, index * 100);\n  });\n}\n"],"names":["PixabayApi","__privateAdd","_BASE_URL","_API_KEY","_query","_page","_per_page","_total_pages","res","axios","__privateGet","error","totalHits","newQuery","__privateSet","newPage","newTotalPages","simpleLightbox","SimpleLightbox","galleryEl","createGallery","images","markup","tags","largeImageURL","webformatURL","likes","views","comments","downloads","clearGallery","showElement","element","hideElement","api","formEl","loader","loadMoreBtn","handleFormSubmit","handleLoadMoreBtnClick","event","iziToast","data","newCards","addAnimationToCards","checkBtnStatus","scrollToNewItems","galleryItem","elementHeight","card","index"],"mappings":"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"}